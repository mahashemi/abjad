<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Quran Output Files</title>
    <style>
      body {
        font-family: sans-serif;
        padding: 2rem;
      }
      ul {
        list-style: none;
        padding: 0;
      }
      li {
        margin: 0.5rem 0;
      }
      a {
        text-decoration: none;
        color: #0366d6;
      }
      a:hover {
        text-decoration: underline;
      }
    </style>
  </head>
  <body>
    <h1>Quran HTML Files</h1>
    <p>Automatically pulled from <code>output/quran</code> in your repo:</p>
    <ul id="file-list">
      <li>Loading…</li>
    </ul>

    <script>
      const USER = "mahashemi"; // ← your GitHub user/org
      const REPO = "abjad"; // ← your repo name
      const FOLDER = "output/quran"; // ← path under repo root

      fetch(`https://api.github.com/repos/${USER}/${REPO}/contents/${FOLDER}`)
        .then((r) => (r.ok ? r.json() : Promise.reject(r.statusText)))
        .then((files) => {
          const ul = document.getElementById("file-list");
          ul.innerHTML = "";

          const htmlFiles = files
            .filter((f) => f.name.toLowerCase().endsWith(".html"))
            .map((f) => {
              const match = f.name.match(/سورة\s(\d+)/); // e.g., سورة 103
              const surahNum = match ? parseInt(match[1], 10) : 0;
              return { ...f, surahNum };
            })
            .sort((a, b) => a.surahNum - b.surahNum); // sort by surah number

          htmlFiles
            .filter((f) => f.name.toLowerCase().endsWith(".html"))
            .forEach((f) => {
              const li = document.createElement("li");
              const a = document.createElement("a");

              // Format surah number as 3-digit string with leading zeros
              const paddedSurah = f.surahNum.toString().padStart(3, "0");

              // link to the *Pages*-hosted HTML file:
              a.href = `https://${USER}.github.io/${REPO}/${FOLDER}/${encodeURIComponent(
                f.name
              )}`;
              a.textContent = `[${paddedSurah}] ${f.name}`;
              // <<< open in new tab safely:
              a.target = "_blank";
              a.rel = "noopener noreferrer";

              li.appendChild(a);
              ul.appendChild(li);
            });
        })
        .catch((err) => {
          document.getElementById(
            "file-list"
          ).innerHTML = `<li style="color: red">Error: ${err}</li>`;
        });
    </script>
  </body>
</html>
